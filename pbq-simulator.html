<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PBQ Simulator | Security+ SY0-701</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0b0e17;
    --bg2: #111520;
    --bg3: #181d2e;
    --border: #1f2740;
    --accent: #00d4ff;
    --accent2: #ff6b2b;
    --green: #00f5a0;
    --red: #ff4757;
    --yellow: #ffd32a;
    --purple: #b47aff;
    --text: #d0d8f0;
    --muted: #5a6a8a;
    --font: 'IBM Plex Sans', sans-serif;
    --mono: 'IBM Plex Mono', monospace;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font);
    min-height: 100vh;
    line-height: 1.6;
    display: flex;
    flex-direction: column;
  }

  /* ‚îÄ‚îÄ HEADER (matches index.html) ‚îÄ‚îÄ */
  header {
    background: var(--bg2);
    border-bottom: 1px solid var(--border);
    padding: 0 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 70px;
  }

  .logo {
    font-family: var(--mono);
    font-size: 0.85rem;
    color: var(--muted);
    letter-spacing: 0.1em;
    text-decoration: none;
  }
  .logo span { color: var(--accent); }

  .header-right {
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }

  .back-link {
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--muted);
    text-decoration: none;
    border: 1px solid var(--border);
    padding: 0.4rem 0.9rem;
    border-radius: 6px;
    transition: all 0.2s;
    letter-spacing: 0.05em;
  }
  .back-link:hover { color: var(--accent); border-color: var(--accent); }

  .score-pills {
    display: flex;
    gap: 0.75rem;
  }

  .score-pill {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: linear-gradient(135deg, rgba(0,212,255,0.08), rgba(0,245,160,0.08));
    border: 1px solid var(--border);
    padding: 0.4rem 0.9rem;
    border-radius: 20px;
    font-family: var(--mono);
    font-size: 0.75rem;
  }
  .score-pill .val { color: var(--accent); font-weight: 600; }
  .score-pill .lbl { color: var(--muted); }

  /* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
  main { flex: 1; padding: 2rem; }

  .container {
    max-width: 1100px;
    width: 100%;
    margin: 0 auto;
  }

  h1 {
    font-size: 2rem;
    font-weight: 600;
    margin-bottom: 0.4rem;
    background: linear-gradient(135deg, var(--accent), var(--green));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-align: center;
  }

  .subtitle {
    color: var(--muted);
    font-size: 0.9rem;
    margin-bottom: 2.5rem;
    font-family: var(--mono);
    letter-spacing: 0.05em;
    text-align: center;
  }

  /* ‚îÄ‚îÄ NAV TABS (matches site style exactly) ‚îÄ‚îÄ */
  .nav-tabs {
    display: flex;
    gap: 0;
    margin-bottom: 2rem;
    border-bottom: 1px solid var(--border);
    overflow-x: auto;
  }

  .nav-tab {
    padding: 1rem 1.5rem;
    background: none;
    border: none;
    color: var(--muted);
    font-family: var(--mono);
    font-size: 0.82rem;
    cursor: pointer;
    border-bottom: 2px solid transparent;
    transition: all 0.25s ease;
    white-space: nowrap;
    letter-spacing: 0.04em;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .nav-tab:hover { color: var(--text); }
  .nav-tab.active { color: var(--accent); border-bottom-color: var(--accent); }

  .tab-content { display: none; }
  .tab-content.active { display: block; }

  /* ‚îÄ‚îÄ SCENARIO CARD (matches stat-card / leaderboard-section style) ‚îÄ‚îÄ */
  .scenario-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 1.5rem;
    position: relative;
    transition: border-color 0.25s;
  }
  .scenario-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    border-radius: 12px 12px 0 0;
    background: linear-gradient(90deg, var(--accent), var(--green), transparent);
  }

  .scenario-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    font-family: var(--mono);
    font-size: 0.7rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--accent);
    background: rgba(0,212,255,0.08);
    border: 1px solid rgba(0,212,255,0.15);
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    margin-bottom: 0.75rem;
  }

  .scenario-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 0.5rem;
  }

  .scenario-desc {
    font-size: 0.9rem;
    color: var(--muted);
    line-height: 1.7;
    margin-bottom: 1.5rem;
  }
  .scenario-desc strong { color: var(--text); }

  /* ‚îÄ‚îÄ INFO BOX ‚îÄ‚îÄ */
  .info-box {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1rem 1.25rem;
    font-family: var(--mono);
    font-size: 0.8rem;
    margin-bottom: 1.5rem;
  }
  .info-box .info-label {
    color: var(--muted);
    font-size: 0.68rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-bottom: 0.4rem;
  }
  .info-box p { color: var(--text); }
  .info-box span { color: var(--accent); }

  /* ‚îÄ‚îÄ TWO-COL DRAG LAYOUT ‚îÄ‚îÄ */
  .drag-cols {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .col-label {
    font-family: var(--mono);
    font-size: 0.7rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 0.75rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border);
  }
  .col-label.accent { color: var(--accent); }
  .col-label.purple { color: var(--purple); }

  .drop-zone {
    min-height: 160px;
    border: 1px dashed var(--border);
    border-radius: 8px;
    padding: 0.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    transition: all 0.2s;
  }
  .drop-zone.dragover {
    border-color: var(--accent);
    background: rgba(0,212,255,0.04);
  }

  .drop-hint {
    color: var(--muted);
    font-size: 0.82rem;
    font-family: var(--mono);
    text-align: center;
    padding: 1.5rem;
    font-style: italic;
  }

  /* ‚îÄ‚îÄ DRAGGABLE ITEMS ‚îÄ‚îÄ */
  .drag-item {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 0.65rem 1rem;
    font-family: var(--mono);
    font-size: 0.78rem;
    cursor: grab;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    user-select: none;
    transition: all 0.2s;
    color: var(--text);
  }
  .drag-item:hover {
    border-color: var(--accent);
    color: var(--accent);
    transform: translateX(2px);
  }
  .drag-item.dragging { opacity: 0.35; }
  .drag-item .handle { color: var(--muted); font-size: 0.9rem; flex-shrink: 0; }

  /* Step number badge inside drop zones */
  .step-num {
    width: 20px; height: 20px;
    border-radius: 50%;
    background: rgba(0,212,255,0.1);
    border: 1px solid rgba(0,212,255,0.25);
    display: flex; align-items: center; justify-content: center;
    font-size: 0.65rem;
    color: var(--accent);
    flex-shrink: 0;
  }

  /* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
  .btn-row {
    display: flex;
    gap: 0.75rem;
    align-items: center;
    margin-top: 1.5rem;
  }

  .btn-primary {
    padding: 0.65rem 1.75rem;
    background: linear-gradient(135deg, rgba(0,212,255,0.15), rgba(0,245,160,0.1));
    border: 1px solid var(--accent);
    border-radius: 6px;
    color: var(--accent);
    font-family: var(--mono);
    font-size: 0.8rem;
    cursor: pointer;
    letter-spacing: 0.06em;
    transition: all 0.2s;
  }
  .btn-primary:hover {
    background: linear-gradient(135deg, rgba(0,212,255,0.25), rgba(0,245,160,0.18));
    box-shadow: 0 0 18px rgba(0,212,255,0.18);
    transform: translateY(-1px);
  }

  .btn-secondary {
    padding: 0.65rem 1.25rem;
    background: none;
    border: 1px solid var(--border);
    border-radius: 6px;
    color: var(--muted);
    font-family: var(--mono);
    font-size: 0.8rem;
    cursor: pointer;
    letter-spacing: 0.06em;
    transition: all 0.2s;
  }
  .btn-secondary:hover { border-color: var(--muted); color: var(--text); }

  /* ‚îÄ‚îÄ FEEDBACK ‚îÄ‚îÄ */
  .feedback {
    display: none;
    margin-top: 1.25rem;
    padding: 1rem 1.25rem;
    border-radius: 8px;
    font-size: 0.88rem;
    line-height: 1.7;
    animation: fadeUp 0.25s ease;
  }
  @keyframes fadeUp { from { opacity:0; transform: translateY(-6px); } to { opacity:1; transform: translateY(0); } }
  .feedback.show { display: block; }
  .feedback.correct {
    background: rgba(0,245,160,0.07);
    border: 1px solid rgba(0,245,160,0.25);
    color: var(--green);
  }
  .feedback.incorrect {
    background: rgba(255,71,87,0.07);
    border: 1px solid rgba(255,71,87,0.25);
    color: var(--red);
  }
  .feedback strong { font-weight: 600; }
  .feedback em { font-style: italic; color: var(--yellow); }

  /* ‚îÄ‚îÄ ACL SPECIFIC ‚îÄ‚îÄ */
  .acl-rule-text em { color: var(--green); font-style: normal; }
  .acl-rule-text em.deny { color: var(--red); }
  .acl-rule-text em.warn { color: var(--yellow); }
  .acl-rule-text em.purple { color: var(--purple); }

  /* ‚îÄ‚îÄ NETWORK DIAGRAM ‚îÄ‚îÄ */
  .network-map {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .net-zone {
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    min-height: 72px;
    transition: all 0.2s;
  }
  .net-zone.dragover { border-color: var(--accent); background: rgba(0,212,255,0.04); }

  .net-zone-label {
    font-family: var(--mono);
    font-size: 0.68rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-bottom: 0.5rem;
  }
  .net-zone.zone-internet { border-color: rgba(255,71,87,0.2); }
  .net-zone.zone-internet .net-zone-label { color: var(--red); }
  .net-zone.zone-dmz { border-color: rgba(255,211,42,0.2); }
  .net-zone.zone-dmz .net-zone-label { color: var(--yellow); }
  .net-zone.zone-internal { border-color: rgba(0,245,160,0.2); }
  .net-zone.zone-internal .net-zone-label { color: var(--green); }

  .zone-divider {
    text-align: center;
    font-family: var(--mono);
    font-size: 0.68rem;
    color: var(--muted);
    letter-spacing: 0.1em;
    padding: 2px 0;
  }

  .device-chips { display: flex; flex-wrap: wrap; gap: 0.4rem; }

  .device-chip {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.35rem 0.75rem;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 20px;
    font-family: var(--mono);
    font-size: 0.75rem;
    cursor: grab;
    user-select: none;
    transition: all 0.2s;
    color: var(--text);
  }
  .device-chip:hover { border-color: var(--accent); color: var(--accent); }
  .device-chip.dragging { opacity: 0.35; }

  /* ‚îÄ‚îÄ LOG ANALYSIS ‚îÄ‚îÄ */
  .log-terminal {
    background: #060910;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 1.25rem;
    font-family: var(--mono);
    font-size: 0.78rem;
    line-height: 2;
    margin-bottom: 1.5rem;
    max-height: 260px;
    overflow-y: auto;
  }
  .log-terminal::-webkit-scrollbar { width: 4px; }
  .log-terminal::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

  .log-line { display: flex; gap: 1rem; }
  .log-time { color: var(--muted); flex-shrink: 0; min-width: 72px; }
  .log-src { color: var(--purple); flex-shrink: 0; min-width: 115px; }
  .log-msg { color: var(--text); }
  .log-msg.warn { color: var(--yellow); }
  .log-msg.err { color: var(--red); }
  .log-msg.ok { color: var(--green); }

  .log-q-title {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text);
    margin-bottom: 0.75rem;
    margin-top: 1.25rem;
  }

  .log-choices { display: flex; flex-direction: column; gap: 0.5rem; }

  .log-choice {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.87rem;
    transition: all 0.2s;
  }
  .log-choice:hover { border-color: var(--accent); background: rgba(0,212,255,0.04); }
  .log-choice.selected { border-color: var(--accent); background: rgba(0,212,255,0.07); color: var(--accent); }
  .log-choice.correct-ans { border-color: var(--green); background: rgba(0,245,160,0.07); color: var(--green); }
  .log-choice.wrong-ans { border-color: var(--red); background: rgba(255,71,87,0.07); color: var(--red); }

  .choice-letter {
    width: 24px; height: 24px;
    border-radius: 50%;
    border: 1px solid currentColor;
    display: flex; align-items: center; justify-content: center;
    font-family: var(--mono);
    font-size: 0.7rem;
    font-weight: 600;
    flex-shrink: 0;
  }

  /* ‚îÄ‚îÄ INCIDENT RESPONSE TIMELINE ‚îÄ‚îÄ */
  .ir-timeline-wrap {
    position: relative;
  }
  .ir-timeline-wrap::before {
    content: '';
    position: absolute;
    left: 16px;
    top: 20px; bottom: 20px;
    width: 1px;
    background: linear-gradient(to bottom, var(--accent), rgba(0,212,255,0.1));
    pointer-events: none;
  }

  .ir-timeline .drag-item {
    margin-left: 38px;
    position: relative;
  }
  .ir-timeline .drag-item::before {
    content: attr(data-num);
    position: absolute;
    left: -30px;
    width: 18px; height: 18px;
    background: var(--accent);
    color: var(--bg);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.65rem;
    font-weight: 600;
    font-family: var(--mono);
  }

  /* ‚îÄ‚îÄ PROGRESS BAR ‚îÄ‚îÄ */
  .pbq-progress {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1rem 1.5rem;
  }
  .pbq-progress-label {
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--muted);
    white-space: nowrap;
  }
  .pbq-progress-bar {
    flex: 1;
    height: 6px;
    background: var(--bg3);
    border-radius: 3px;
    overflow: hidden;
  }
  .pbq-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--green));
    border-radius: 3px;
    transition: width 0.4s ease;
  }
  .pbq-progress-score {
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--accent);
    white-space: nowrap;
  }

  /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
  footer {
    background: var(--bg2);
    border-top: 1px solid var(--border);
    padding: 1.5rem 2rem;
    text-align: center;
    font-size: 0.85rem;
    color: var(--muted);
    font-family: var(--mono);
  }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media(max-width: 680px) {
    .drag-cols { grid-template-columns: 1fr; }
    header { padding: 0 1rem; }
    main { padding: 1.25rem; }
    .score-pills { gap: 0.4rem; }
    .score-pill .lbl { display: none; }
  }

  /* ‚îÄ‚îÄ PORT BUCKETS ‚îÄ‚îÄ */
  .port-bucket {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 0.5rem 0.75rem;
    min-height: 42px;
    transition: all 0.2s;
  }
  .port-bucket.dragover { border-color: var(--accent); background: rgba(0,212,255,0.05); }
  .port-num {
    font-family: var(--mono);
    font-size: 0.72rem;
    color: var(--accent);
    font-weight: 600;
    min-width: 44px;
    flex-shrink: 0;
  }
  .port-label {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--muted);
    min-width: 80px;
    flex-shrink: 0;
  }
  .port-chips { display: flex; flex-wrap: wrap; gap: 0.3rem; flex: 1; }

  /* ‚îÄ‚îÄ CRYPTO BUCKETS ‚îÄ‚îÄ */
  .crypto-bucket {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    min-height: 70px;
    transition: all 0.2s;
  }
  .crypto-bucket.dragover { border-color: var(--accent); background: rgba(0,212,255,0.04); }
  .crypto-bucket-label {
    font-family: var(--mono);
    font-size: 0.72rem;
    letter-spacing: 0.08em;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  /* ‚îÄ‚îÄ VULN CARDS ‚îÄ‚îÄ */
  .vuln-card {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    cursor: grab;
    transition: all 0.2s;
    user-select: none;
  }
  .vuln-card:hover { border-color: var(--accent); transform: translateX(2px); }
  .vuln-card.dragging { opacity: 0.35; }
  .vuln-header { display: flex; align-items: center; gap: 0.6rem; margin-bottom: 0.3rem; }
  .vuln-name { font-size: 0.85rem; font-weight: 600; color: var(--text); }
  .vuln-detail { font-size: 0.78rem; color: var(--muted); line-height: 1.5; }
  .cvss-badge {
    font-family: var(--mono);
    font-size: 0.68rem;
    font-weight: 600;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    flex-shrink: 0;
  }
  .cvss-badge.critical { background: rgba(255,71,87,0.2); color: var(--red); border: 1px solid rgba(255,71,87,0.3); }
  .cvss-badge.high { background: rgba(255,107,43,0.2); color: var(--accent2); border: 1px solid rgba(255,107,43,0.3); }
  .cvss-badge.medium { background: rgba(255,211,42,0.2); color: var(--yellow); border: 1px solid rgba(255,211,42,0.3); }
  .cvss-badge.low { background: rgba(0,245,160,0.1); color: var(--green); border: 1px solid rgba(0,245,160,0.2); }

  /* Vuln queue numbering (reuse IR timeline style) */
  #vuln-queue .vuln-card { margin-left: 38px; position: relative; }
  #vuln-queue .vuln-card::before {
    content: attr(data-num);
    position: absolute;
    left: -30px;
    width: 18px; height: 18px;
    background: var(--accent);
    color: var(--bg);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.65rem; font-weight: 600;
    font-family: var(--mono);
  }

  /* ‚îÄ‚îÄ IAM ROLE BOXES ‚îÄ‚îÄ */
  .iam-role-box {
    background: var(--bg3);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    min-height: 90px;
    transition: all 0.2s;
  }
  .iam-role-box.dragover { border-color: var(--accent); background: rgba(0,212,255,0.04); }
  .iam-role-label {
    font-family: var(--mono);
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--accent);
    margin-bottom: 0.5rem;
    letter-spacing: 0.05em;
  }

</style>
</head>
<body>

<header>
  <a href="index.html" class="logo">SECURITY+ <span>SY0-701</span> PRACTICE EXAMS</a>
  <div class="header-right">
    <a href="index.html" class="back-link">‚Üê BACK</a>
    <div class="score-pills">
      <div class="score-pill"><span class="val" id="score-correct">0</span><span class="lbl">correct</span></div>
      <div class="score-pill"><span class="val" id="score-attempts">0</span><span class="lbl">attempts</span></div>
    </div>
  </div>
</header>

<main>
<div class="container">

  <h1>Performance-Based Questions</h1>
  <p class="subtitle">// drag-and-drop interactive simulations ¬∑ SY0-701</p>

  <!-- Progress -->
  <div class="pbq-progress">
    <span class="pbq-progress-label">PBQ PROGRESS</span>
    <div class="pbq-progress-bar"><div class="pbq-progress-fill" id="prog-fill" style="width:12.5%"></div></div>
    <span class="pbq-progress-score" id="prog-label">1 / 8</span>
  </div>

  <!-- NAV TABS -->
  <div class="nav-tabs">
    <button class="nav-tab active" onclick="switchTab('acl',this,1)">üõ°Ô∏è Firewall ACL</button>
    <button class="nav-tab" onclick="switchTab('net',this,2)">üåê Network Diagram</button>
    <button class="nav-tab" onclick="switchTab('log',this,3)">üìã Log Analysis</button>
    <button class="nav-tab" onclick="switchTab('ir',this,4)">üö® Incident Response</button>
    <button class="nav-tab" onclick="switchTab('ports',this,5)">üîå Port Matching</button>
    <button class="nav-tab" onclick="switchTab('crypto',this,6)">üîê Cryptography</button>
    <button class="nav-tab" onclick="switchTab('vuln',this,7)">üéØ Vuln Prioritization</button>
    <button class="nav-tab" onclick="switchTab('iam',this,8)">üë§ Access Control</button>
  </div>

  <!-- ============ TAB 1: FIREWALL ACL ============ -->
  <div class="tab-content active" id="tab-acl">
    <div class="scenario-card">
      <div class="scenario-badge">PBQ-01 ¬∑ Firewall / ACL Configuration</div>
      <div class="scenario-title">Configure the Perimeter Firewall Ruleset</div>
      <div class="scenario-desc">
        A company's web server sits in the DMZ at <strong>10.10.1.5</strong>. Configure the firewall ACL to:
        allow HTTPS inbound from any source, allow SSH only from the admin subnet <strong>192.168.1.0/24</strong>,
        and block all other inbound traffic. The firewall processes rules <strong>top-to-bottom, first match wins</strong>.
        Drag the correct rules into the ACL in the right order.
      </div>

      <div class="info-box">
        <div class="info-label">// Network Context</div>
        <p>Web Server: <span>10.10.1.5</span> &nbsp;¬∑&nbsp; Admin Subnet: <span>192.168.1.0/24</span> &nbsp;¬∑&nbsp; Zone: <span>DMZ</span></p>
      </div>

      <div class="drag-cols">
        <div>
          <div class="col-label purple">Available Rules</div>
          <div class="drop-zone" id="acl-pool" ondragover="dov(event)" ondrop="aclDropPool(event)" ondragleave="dlv(event)">
            <div class="drag-item" draggable="true" data-rule="PERMIT TCP any 10.10.1.5 443" ondragstart="ds(event,'acl')" ondragend="de(event)">
              <span class="handle">‚†ø</span>
              <span class="acl-rule-text">PERMIT TCP <em>any</em> ‚Üí 10.10.1.5:<em>443</em></span>
            </div>
            <div class="drag-item" draggable="true" data-rule="PERMIT TCP 192.168.1.0/24 10.10.1.5 22" ondragstart="ds(event,'acl')" ondragend="de(event)">
              <span class="handle">‚†ø</span>
              <span class="acl-rule-text">PERMIT TCP <em class="purple">192.168.1.0/24</em> ‚Üí 10.10.1.5:<em>22</em></span>
            </div>
            <div class="drag-item" draggable="true" data-rule="DENY TCP any 10.10.1.5 22" ondragstart="ds(event,'acl')" ondragend="de(event)">
              <span class="handle">‚†ø</span>
              <span class="acl-rule-text">DENY TCP <em class="deny">any</em> ‚Üí 10.10.1.5:<em class="deny">22</em></span>
            </div>
            <div class="drag-item" draggable="true" data-rule="DENY IP any any" ondragstart="ds(event,'acl')" ondragend="de(event)">
              <span class="handle">‚†ø</span>
              <span class="acl-rule-text">DENY IP <em class="deny">any</em> ‚Üí <em class="deny">any</em></span>
            </div>
            <div class="drag-item" draggable="true" data-rule="PERMIT TCP any 10.10.1.5 80" ondragstart="ds(event,'acl')" ondragend="de(event)">
              <span class="handle">‚†ø</span>
              <span class="acl-rule-text">PERMIT TCP <em class="warn">any</em> ‚Üí 10.10.1.5:<em class="warn">80</em></span>
            </div>
          </div>
        </div>
        <div>
          <div class="col-label accent">Active ACL ‚Äî ordered top to bottom</div>
          <div class="drop-zone" id="acl-list" ondragover="dov(event)" ondrop="aclDropList(event)" ondragleave="dlv(event)">
            <div class="drop-hint">Drop rules here in the correct order ‚Üì</div>
          </div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn-primary" onclick="checkACL()">‚ñ∂ CHECK ANSWER</button>
        <button class="btn-secondary" onclick="resetACL()">‚Ü∫ RESET</button>
      </div>
      <div class="feedback" id="fb-acl"></div>
    </div>
  </div>

  <!-- ============ TAB 2: NETWORK DIAGRAM ============ -->
  <div class="tab-content" id="tab-net">
    <div class="scenario-card">
      <div class="scenario-badge">PBQ-02 ¬∑ Network Diagram Analysis</div>
      <div class="scenario-title">Place Devices in the Correct Network Zones</div>
      <div class="scenario-desc">
        Drag each device into its correct security zone. The <strong>DMZ</strong> hosts publicly accessible services while isolating them from internal systems.
        Place each device where it belongs based on its function and trust level.
      </div>

      <div class="drag-cols">
        <div>
          <div class="col-label purple">Unplaced Devices</div>
          <div class="drop-zone" id="net-pool" style="min-height:120px"
            ondragover="dov(event)" ondrop="netDrop(event,'net-pool')" ondragleave="dlv(event)">
            <div class="device-chips" id="net-pool-chips">
              <div class="device-chip" draggable="true" data-device="Web Server" data-zone="zone-dmz" ondragstart="ds(event,'net')" ondragend="de(event)">üñ•Ô∏è Web Server</div>
              <div class="device-chip" draggable="true" data-device="Public DNS" data-zone="zone-dmz" ondragstart="ds(event,'net')" ondragend="de(event)">üì° Public DNS</div>
              <div class="device-chip" draggable="true" data-device="HR Database" data-zone="zone-internal" ondragstart="ds(event,'net')" ondragend="de(event)">üóÑÔ∏è HR Database</div>
              <div class="device-chip" draggable="true" data-device="Workstations" data-zone="zone-internal" ondragstart="ds(event,'net')" ondragend="de(event)">üíª Workstations</div>
              <div class="device-chip" draggable="true" data-device="Mail Gateway" data-zone="zone-dmz" ondragstart="ds(event,'net')" ondragend="de(event)">üìß Mail Gateway</div>
              <div class="device-chip" draggable="true" data-device="External User" data-zone="zone-internet" ondragstart="ds(event,'net')" ondragend="de(event)">üë§ External User</div>
            </div>
          </div>
        </div>
        <div>
          <div class="col-label accent">Network Security Zones</div>
          <div class="network-map">
            <div class="net-zone zone-internet" id="zone-internet" ondragover="dov(event)" ondrop="netDrop(event,'zone-internet')" ondragleave="dlv(event)">
              <div class="net-zone-label">üåç Internet ‚Äî Untrusted</div>
              <div class="device-chips" id="zone-internet-chips"></div>
            </div>
            <div class="zone-divider">‚îÄ‚îÄ Perimeter Firewall ‚îÄ‚îÄ</div>
            <div class="net-zone zone-dmz" id="zone-dmz" ondragover="dov(event)" ondrop="netDrop(event,'zone-dmz')" ondragleave="dlv(event)">
              <div class="net-zone-label">‚ö†Ô∏è DMZ ‚Äî Semi-Trusted</div>
              <div class="device-chips" id="zone-dmz-chips"></div>
            </div>
            <div class="zone-divider">‚îÄ‚îÄ Internal Firewall ‚îÄ‚îÄ</div>
            <div class="net-zone zone-internal" id="zone-internal" ondragover="dov(event)" ondrop="netDrop(event,'zone-internal')" ondragleave="dlv(event)">
              <div class="net-zone-label">üîí Internal ‚Äî Trusted</div>
              <div class="device-chips" id="zone-internal-chips"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn-primary" onclick="checkNet()">‚ñ∂ CHECK ANSWER</button>
        <button class="btn-secondary" onclick="resetNet()">‚Ü∫ RESET</button>
      </div>
      <div class="feedback" id="fb-net"></div>
    </div>
  </div>

  <!-- ============ TAB 3: LOG ANALYSIS ============ -->
  <div class="tab-content" id="tab-log">
    <div class="scenario-card">
      <div class="scenario-badge">PBQ-03 ¬∑ Log Analysis / SIEM</div>
      <div class="scenario-title">Identify the Attack from Authentication Logs</div>
      <div class="scenario-desc">
        Review these authentication logs captured by the SIEM. Analyze the patterns ‚Äî look at the source IP,
        timing, usernames, and failure counts ‚Äî then answer the questions below.
      </div>

      <div class="log-terminal">
        <div class="log-line"><span class="log-time">09:14:02</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: admin</span></div>
        <div class="log-line"><span class="log-time">09:14:03</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: admin</span></div>
        <div class="log-line"><span class="log-time">09:14:04</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: admin</span></div>
        <div class="log-line"><span class="log-time">09:14:05</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: administrator</span></div>
        <div class="log-line"><span class="log-time">09:14:06</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: root</span></div>
        <div class="log-line"><span class="log-time">09:14:07</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: sysadmin</span></div>
        <div class="log-line"><span class="log-time">09:14:08</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: guest</span></div>
        <div class="log-line"><span class="log-time">09:14:09</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: support</span></div>
        <div class="log-line"><span class="log-time">09:14:10</span><span class="log-src">203.0.113.45</span><span class="log-msg warn">ACCOUNT LOCKED ‚Äî user: admin (5 failures)</span></div>
        <div class="log-line"><span class="log-time">09:15:22</span><span class="log-src">10.0.0.12</span><span class="log-msg ok">SUCCESS login ‚Äî user: jsmith</span></div>
        <div class="log-line"><span class="log-time">09:17:45</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: jsmith</span></div>
        <div class="log-line"><span class="log-time">09:17:46</span><span class="log-src">203.0.113.45</span><span class="log-msg err">FAILED login ‚Äî user: jsmith</span></div>
        <div class="log-line"><span class="log-time">09:17:47</span><span class="log-src">203.0.113.45</span><span class="log-msg warn">ACCOUNT LOCKED ‚Äî user: jsmith</span></div>
      </div>

      <div class="log-q-title">Q1 ‚Äî What type of attack is being conducted from 203.0.113.45?</div>
      <div class="log-choices" id="log-q1">
        <div class="log-choice" onclick="logPick('q1','A',this)"><span class="choice-letter">A</span>Password spraying ‚Äî one password tried against many accounts</div>
        <div class="log-choice" onclick="logPick('q1','B',this)"><span class="choice-letter">B</span>Brute force ‚Äî many passwords tried against a single account</div>
        <div class="log-choice" onclick="logPick('q1','C',this)"><span class="choice-letter">C</span>Username enumeration / dictionary attack against multiple usernames</div>
        <div class="log-choice" onclick="logPick('q1','D',this)"><span class="choice-letter">D</span>Credential stuffing using previously breached credentials</div>
      </div>

      <div class="log-q-title">Q2 ‚Äî Which control would BEST mitigate this attack going forward?</div>
      <div class="log-choices" id="log-q2">
        <div class="log-choice" onclick="logPick('q2','A',this)"><span class="choice-letter">A</span>Increase minimum password complexity requirements</div>
        <div class="log-choice" onclick="logPick('q2','B',this)"><span class="choice-letter">B</span>Account lockout policy with geo-IP blocking on the login page</div>
        <div class="log-choice" onclick="logPick('q2','C',this)"><span class="choice-letter">C</span>Implement MFA and rate limiting on the authentication endpoint</div>
        <div class="log-choice" onclick="logPick('q2','D',this)"><span class="choice-letter">D</span>Enable full-disk encryption on the authentication server</div>
      </div>

      <div class="btn-row">
        <button class="btn-primary" onclick="checkLog()">‚ñ∂ CHECK ANSWER</button>
        <button class="btn-secondary" onclick="resetLog()">‚Ü∫ RESET</button>
      </div>
      <div class="feedback" id="fb-log"></div>
    </div>
  </div>

  <!-- ============ TAB 4: INCIDENT RESPONSE ============ -->
  <div class="tab-content" id="tab-ir">
    <div class="scenario-card">
      <div class="scenario-badge">PBQ-04 ¬∑ Incident Response Sequencing</div>
      <div class="scenario-title">Sequence the IR Steps ‚Äî Ransomware Incident</div>
      <div class="scenario-desc">
        A ransomware attack has been detected on a workstation. Drag the response steps into the correct order
        based on the <strong>NIST SP 800-61</strong> incident response lifecycle. Order matters ‚Äî wrong sequencing
        can destroy evidence or allow the attacker to persist.
      </div>

      <div class="drag-cols">
        <div>
          <div class="col-label purple">IR Steps ‚Äî Drag to Timeline</div>
          <div class="drop-zone" id="ir-pool" ondragover="dov(event)" ondrop="irDrop(event,'ir-pool')" ondragleave="dlv(event)">
            <div class="drag-item" draggable="true" data-step="Eradicate malware and patch vulnerabilities" data-order="5" ondragstart="ds(event,'ir')" ondragend="de(event)">
              <span class="handle">‚†ø</span><span>üßπ Eradicate malware &amp; patch vulnerabilities</span>
            </div>
            <div class="drag-item" draggable="true" data-step="Notify stakeholders and document findings" data-order="7" ondragstart="ds(event,'ir')" ondragend="de(event)">
              <span class="handle">‚†ø</span><span>üì£ Notify stakeholders &amp; document</span>
            </div>
            <div class="drag-item" draggable="true" data-step="Isolate the affected system from network" data-order="2" ondragstart="ds(event,'ir')" ondragend="de(event)">
              <span class="handle">‚†ø</span><span>üîå Isolate affected system from network</span>
            </div>
            <div class="drag-item" draggable="true" data-step="Detect and identify the ransomware alert" data-order="1" ondragstart="ds(event,'ir')" ondragend="de(event)">
              <span class="handle">‚†ø</span><span>üîç Detect &amp; identify the ransomware alert</span>
            </div>
            <div class="drag-item" draggable="true" data-step="Restore from clean backup and verify integrity" data-order="6" ondragstart="ds(event,'ir')" ondragend="de(event)">
              <span class="handle">‚†ø</span><span>üíæ Restore from clean backup &amp; verify</span>
            </div>
            <div class="drag-item" draggable="true" data-step="Preserve forensic evidence and disk image" data-order="3" ondragstart="ds(event,'ir')" ondragend="de(event)">
              <span class="handle">‚†ø</span><span>üî¨ Preserve forensic evidence &amp; disk image</span>
            </div>
            <div class="drag-item" draggable="true" data-step="Conduct post-incident lessons learned review" data-order="8" ondragstart="ds(event,'ir')" ondragend="de(event)">
              <span class="handle">‚†ø</span><span>üìù Post-incident lessons learned review</span>
            </div>
            <div class="drag-item" draggable="true" data-step="Analyze scope ‚Äî identify IOCs and lateral movement" data-order="4" ondragstart="ds(event,'ir')" ondragend="de(event)">
              <span class="handle">‚†ø</span><span>üó∫Ô∏è Analyze scope ‚Äî IOCs &amp; lateral movement</span>
            </div>
          </div>
        </div>
        <div>
          <div class="col-label accent">Response Timeline ‚Äî First ‚Üí Last</div>
          <div class="drop-zone ir-timeline-wrap" id="ir-timeline" ondragover="dov(event)" ondrop="irDrop(event,'ir-timeline')" ondragleave="dlv(event)" style="min-height:280px;">
            <div class="drop-hint">Drop steps here in the correct order ‚Üì</div>
          </div>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn-primary" onclick="checkIR()">‚ñ∂ CHECK ANSWER</button>
        <button class="btn-secondary" onclick="resetIR()">‚Ü∫ RESET</button>
      </div>
      <div class="feedback" id="fb-ir"></div>
    </div>
  </div>


  <!-- ============ TAB 5: PORT & PROTOCOL MATCHING ============ -->
  <div class="tab-content" id="tab-ports">
    <div class="scenario-card">
      <div class="scenario-badge">PBQ-05 ¬∑ Port &amp; Protocol Matching</div>
      <div class="scenario-title">Match Services to Their Correct Default Ports</div>
      <div class="scenario-desc">
        Drag each network service chip into the correct port number bucket. Knowing default ports is essential for firewall configuration, log analysis, and identifying anomalous traffic ‚Äî all heavily tested on SY0-701. Note: <strong>SSH and SFTP both use port 22</strong>.
      </div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:1.5rem; margin-bottom:1.5rem;">
        <div>
          <div class="col-label purple">Services ‚Äî Drag to Port Bucket</div>
          <div class="drop-zone" id="ports-pool" style="min-height:140px; flex-wrap:wrap; flex-direction:row; gap:0.4rem;"
            ondragover="dov(event)" ondrop="portDrop(event,'ports-pool')" ondragleave="dlv(event)">
            <div class="device-chip" draggable="true" data-service="HTTPS" data-port="443" ondragstart="ds(event,'port')" ondragend="de(event)">HTTPS</div>
            <div class="device-chip" draggable="true" data-service="SSH" data-port="22" ondragstart="ds(event,'port')" ondragend="de(event)">SSH</div>
            <div class="device-chip" draggable="true" data-service="DNS" data-port="53" ondragstart="ds(event,'port')" ondragend="de(event)">DNS</div>
            <div class="device-chip" draggable="true" data-service="RDP" data-port="3389" ondragstart="ds(event,'port')" ondragend="de(event)">RDP</div>
            <div class="device-chip" draggable="true" data-service="SMTP" data-port="25" ondragstart="ds(event,'port')" ondragend="de(event)">SMTP</div>
            <div class="device-chip" draggable="true" data-service="LDAP" data-port="389" ondragstart="ds(event,'port')" ondragend="de(event)">LDAP</div>
            <div class="device-chip" draggable="true" data-service="SNMP" data-port="161" ondragstart="ds(event,'port')" ondragend="de(event)">SNMP</div>
            <div class="device-chip" draggable="true" data-service="Kerberos" data-port="88" ondragstart="ds(event,'port')" ondragend="de(event)">Kerberos</div>
            <div class="device-chip" draggable="true" data-service="FTPS" data-port="990" ondragstart="ds(event,'port')" ondragend="de(event)">FTPS</div>
            <div class="device-chip" draggable="true" data-service="SFTP" data-port="22" ondragstart="ds(event,'port')" ondragend="de(event)">SFTP</div>
          </div>
        </div>
        <div>
          <div class="col-label accent">Port Buckets</div>
          <div style="display:flex; flex-direction:column; gap:0.4rem;">
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-22')" ondragleave="dlv(event)"><span class="port-num">:22</span><span class="port-label">TCP 22</span><div class="port-chips" id="bucket-22-chips"></div></div>
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-25')" ondragleave="dlv(event)"><span class="port-num">:25</span><span class="port-label">TCP 25</span><div class="port-chips" id="bucket-25-chips"></div></div>
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-53')" ondragleave="dlv(event)"><span class="port-num">:53</span><span class="port-label">UDP/TCP 53</span><div class="port-chips" id="bucket-53-chips"></div></div>
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-88')" ondragleave="dlv(event)"><span class="port-num">:88</span><span class="port-label">TCP 88</span><div class="port-chips" id="bucket-88-chips"></div></div>
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-161')" ondragleave="dlv(event)"><span class="port-num">:161</span><span class="port-label">UDP 161</span><div class="port-chips" id="bucket-161-chips"></div></div>
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-389')" ondragleave="dlv(event)"><span class="port-num">:389</span><span class="port-label">TCP 389</span><div class="port-chips" id="bucket-389-chips"></div></div>
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-443')" ondragleave="dlv(event)"><span class="port-num">:443</span><span class="port-label">TCP 443</span><div class="port-chips" id="bucket-443-chips"></div></div>
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-990')" ondragleave="dlv(event)"><span class="port-num">:990</span><span class="port-label">TCP 990</span><div class="port-chips" id="bucket-990-chips"></div></div>
            <div class="port-bucket" ondragover="dov(event)" ondrop="portDrop(event,'bucket-3389')" ondragleave="dlv(event)"><span class="port-num">:3389</span><span class="port-label">TCP 3389</span><div class="port-chips" id="bucket-3389-chips"></div></div>
          </div>
        </div>
      </div>
      <div class="btn-row">
        <button class="btn-primary" onclick="checkPorts()">&#9654; CHECK ANSWER</button>
        <button class="btn-secondary" onclick="resetPorts()">&#8635; RESET</button>
      </div>
      <div class="feedback" id="fb-ports"></div>
    </div>
  </div>

  <!-- ============ TAB 6: CRYPTOGRAPHY ============ -->
  <div class="tab-content" id="tab-crypto">
    <div class="scenario-card">
      <div class="scenario-badge">PBQ-06 ¬∑ Cryptography Algorithm Matching</div>
      <div class="scenario-title">Match Algorithms to Their Cryptographic Category</div>
      <div class="scenario-desc">
        Drag each algorithm into its correct category: <strong>Symmetric Encryption</strong>, <strong>Asymmetric Encryption</strong>, <strong>Hashing / Integrity</strong>, or <strong>Key Exchange</strong>. These distinctions are critical for PKI, TLS, and data-at-rest questions on SY0-701.
      </div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:1.5rem; margin-bottom:1.5rem;">
        <div>
          <div class="col-label purple">Algorithms ‚Äî Drag to Category</div>
          <div class="drop-zone" id="crypto-pool" style="min-height:180px; flex-wrap:wrap; flex-direction:row; gap:0.4rem;"
            ondragover="dov(event)" ondrop="cryptoDrop(event,'crypto-pool')" ondragleave="dlv(event)">
            <div class="device-chip" draggable="true" data-algo="AES" data-cat="symmetric" ondragstart="ds(event,'crypto')" ondragend="de(event)">AES</div>
            <div class="device-chip" draggable="true" data-algo="RSA" data-cat="asymmetric" ondragstart="ds(event,'crypto')" ondragend="de(event)">RSA</div>
            <div class="device-chip" draggable="true" data-algo="SHA-256" data-cat="hashing" ondragstart="ds(event,'crypto')" ondragend="de(event)">SHA-256</div>
            <div class="device-chip" draggable="true" data-algo="Diffie-Hellman" data-cat="keyexchange" ondragstart="ds(event,'crypto')" ondragend="de(event)">Diffie-Hellman</div>
            <div class="device-chip" draggable="true" data-algo="3DES" data-cat="symmetric" ondragstart="ds(event,'crypto')" ondragend="de(event)">3DES</div>
            <div class="device-chip" draggable="true" data-algo="ECC" data-cat="asymmetric" ondragstart="ds(event,'crypto')" ondragend="de(event)">ECC</div>
            <div class="device-chip" draggable="true" data-algo="MD5" data-cat="hashing" ondragstart="ds(event,'crypto')" ondragend="de(event)">MD5</div>
            <div class="device-chip" draggable="true" data-algo="ECDH" data-cat="keyexchange" ondragstart="ds(event,'crypto')" ondragend="de(event)">ECDH</div>
            <div class="device-chip" draggable="true" data-algo="ChaCha20" data-cat="symmetric" ondragstart="ds(event,'crypto')" ondragend="de(event)">ChaCha20</div>
            <div class="device-chip" draggable="true" data-algo="BCRYPT" data-cat="hashing" ondragstart="ds(event,'crypto')" ondragend="de(event)">BCRYPT</div>
            <div class="device-chip" draggable="true" data-algo="DSA" data-cat="asymmetric" ondragstart="ds(event,'crypto')" ondragend="de(event)">DSA</div>
            <div class="device-chip" draggable="true" data-algo="ECDHE" data-cat="keyexchange" ondragstart="ds(event,'crypto')" ondragend="de(event)">ECDHE</div>
          </div>
        </div>
        <div>
          <div class="col-label accent">Categories</div>
          <div style="display:flex; flex-direction:column; gap:0.6rem;">
            <div class="crypto-bucket" ondragover="dov(event)" ondrop="cryptoDrop(event,'cat-symmetric')" ondragleave="dlv(event)">
              <div class="crypto-bucket-label" style="color:var(--accent)">Symmetric Encryption</div>
              <div class="port-chips" id="cat-symmetric-chips"></div>
            </div>
            <div class="crypto-bucket" ondragover="dov(event)" ondrop="cryptoDrop(event,'cat-asymmetric')" ondragleave="dlv(event)">
              <div class="crypto-bucket-label" style="color:var(--purple)">Asymmetric Encryption</div>
              <div class="port-chips" id="cat-asymmetric-chips"></div>
            </div>
            <div class="crypto-bucket" ondragover="dov(event)" ondrop="cryptoDrop(event,'cat-hashing')" ondragleave="dlv(event)">
              <div class="crypto-bucket-label" style="color:var(--yellow)">Hashing / Integrity</div>
              <div class="port-chips" id="cat-hashing-chips"></div>
            </div>
            <div class="crypto-bucket" ondragover="dov(event)" ondrop="cryptoDrop(event,'cat-keyexchange')" ondragleave="dlv(event)">
              <div class="crypto-bucket-label" style="color:var(--green)">Key Exchange</div>
              <div class="port-chips" id="cat-keyexchange-chips"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="btn-row">
        <button class="btn-primary" onclick="checkCrypto()">&#9654; CHECK ANSWER</button>
        <button class="btn-secondary" onclick="resetCrypto()">&#8635; RESET</button>
      </div>
      <div class="feedback" id="fb-crypto"></div>
    </div>
  </div>

  <!-- ============ TAB 7: VULNERABILITY PRIORITIZATION ============ -->
  <div class="tab-content" id="tab-vuln">
    <div class="scenario-card">
      <div class="scenario-badge">PBQ-07 ¬∑ Vulnerability Prioritization</div>
      <div class="scenario-title">Rank Vulnerabilities by Remediation Priority</div>
      <div class="scenario-desc">
        A vulnerability scan returned findings for a production, internet-facing e-commerce platform. Drag them into the remediation queue ‚Äî <strong>highest priority first</strong>. Consider CVSS score, exploitability, public exploit availability, and business context.
      </div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:1.5rem; margin-bottom:1.5rem;">
        <div>
          <div class="col-label purple">Scan Findings</div>
          <div class="drop-zone" id="vuln-pool" ondragover="dov(event)" ondrop="vulnDrop(event,'vuln-pool')" ondragleave="dlv(event)" style="gap:0.6rem;">
            <div class="vuln-card" draggable="true" data-vuln="SQLi" data-priority="1" ondragstart="ds(event,'vuln')" ondragend="de(event)">
              <div class="vuln-header"><span class="cvss-badge critical">CVSS 9.8</span><span class="vuln-name">SQL Injection ‚Äî Login Form</span></div>
              <div class="vuln-detail">Unauthenticated attacker can dump the entire user database via unsanitized input</div>
            </div>
            <div class="vuln-card" draggable="true" data-vuln="TLS" data-priority="4" ondragstart="ds(event,'vuln')" ondragend="de(event)">
              <div class="vuln-header"><span class="cvss-badge medium">CVSS 5.3</span><span class="vuln-name">TLS 1.0 Still Supported</span></div>
              <div class="vuln-detail">Server accepts TLS 1.0, enabling POODLE-style downgrade attacks on older clients</div>
            </div>
            <div class="vuln-card" draggable="true" data-vuln="RCE" data-priority="2" ondragstart="ds(event,'vuln')" ondragend="de(event)">
              <div class="vuln-header"><span class="cvss-badge critical">CVSS 9.0</span><span class="vuln-name">RCE ‚Äî Unpatched Apache</span></div>
              <div class="vuln-detail">Known CVE with public exploit ‚Äî RCE on web server, patch available for 30 days</div>
            </div>
            <div class="vuln-card" draggable="true" data-vuln="NoMFA" data-priority="3" ondragstart="ds(event,'vuln')" ondragend="de(event)">
              <div class="vuln-header"><span class="cvss-badge high">CVSS 7.5</span><span class="vuln-name">Admin Panel ‚Äî No MFA</span></div>
              <div class="vuln-detail">Internet-accessible admin UI with password-only auth and no rate limiting</div>
            </div>
            <div class="vuln-card" draggable="true" data-vuln="Banner" data-priority="5" ondragstart="ds(event,'vuln')" ondragend="de(event)">
              <div class="vuln-header"><span class="cvss-badge low">CVSS 3.1</span><span class="vuln-name">Server Version Disclosure</span></div>
              <div class="vuln-detail">HTTP headers expose Apache version and OS ‚Äî aids attacker reconnaissance</div>
            </div>
          </div>
        </div>
        <div>
          <div class="col-label accent">Remediation Queue ‚Äî Highest Priority First</div>
          <div class="drop-zone ir-timeline-wrap" id="vuln-queue" ondragover="dov(event)" ondrop="vulnDrop(event,'vuln-queue')" ondragleave="dlv(event)" style="min-height:280px; gap:0.6rem;">
            <div class="drop-hint">Drop vulnerabilities here in priority order</div>
          </div>
        </div>
      </div>
      <div class="btn-row">
        <button class="btn-primary" onclick="checkVuln()">&#9654; CHECK ANSWER</button>
        <button class="btn-secondary" onclick="resetVuln()">&#8635; RESET</button>
      </div>
      <div class="feedback" id="fb-vuln"></div>
    </div>
  </div>

  <!-- ============ TAB 8: ACCESS CONTROL / IAM ============ -->
  <div class="tab-content" id="tab-iam">
    <div class="scenario-card">
      <div class="scenario-badge">PBQ-08 ¬∑ Access Control / IAM</div>
      <div class="scenario-title">Assign Least-Privilege Permissions to Roles</div>
      <div class="scenario-desc">
        Apply the <strong>principle of least privilege</strong>. Drag each permission chip into every role that should have it. A permission may belong to multiple roles ‚Äî drag it into each applicable role box. <strong>Double-click</strong> a chip inside a role box to remove it.
      </div>
      <div class="info-box" style="margin-bottom:1.25rem;">
        <div class="info-label">// System: HR Management Platform</div>
        <p>Roles: <span>Employee</span> &nbsp;|&nbsp; <span>HR Manager</span> &nbsp;|&nbsp; <span>IT Admin</span> &nbsp;|&nbsp; <span>Auditor</span></p>
      </div>
      <div class="col-label purple" style="margin-bottom:0.75rem;">Permissions Pool ‚Äî Drag to Role(s)</div>
      <div class="drop-zone" id="iam-pool" style="min-height:72px; flex-wrap:wrap; flex-direction:row; gap:0.4rem; margin-bottom:1.25rem;"
        ondragover="dov(event)" ondrop="iamDrop(event,'iam-pool')" ondragleave="dlv(event)">
        <div class="device-chip" draggable="true" data-perm="View own payslip" data-roles="employee,hr_manager" ondragstart="ds(event,'iam')" ondragend="de(event)">View own payslip</div>
        <div class="device-chip" draggable="true" data-perm="View all employee records" data-roles="hr_manager,auditor" ondragstart="ds(event,'iam')" ondragend="de(event)">View all employee records</div>
        <div class="device-chip" draggable="true" data-perm="Modify employee salary" data-roles="hr_manager" ondragstart="ds(event,'iam')" ondragend="de(event)">Modify employee salary</div>
        <div class="device-chip" draggable="true" data-perm="Reset user passwords" data-roles="it_admin" ondragstart="ds(event,'iam')" ondragend="de(event)">Reset user passwords</div>
        <div class="device-chip" draggable="true" data-perm="Create/delete accounts" data-roles="it_admin" ondragstart="ds(event,'iam')" ondragend="de(event)">Create/delete accounts</div>
        <div class="device-chip" draggable="true" data-perm="View audit logs" data-roles="it_admin,auditor" ondragstart="ds(event,'iam')" ondragend="de(event)">View audit logs</div>
        <div class="device-chip" draggable="true" data-perm="Export payroll data" data-roles="hr_manager" ondragstart="ds(event,'iam')" ondragend="de(event)">Export payroll data</div>
        <div class="device-chip" draggable="true" data-perm="Modify system config" data-roles="it_admin" ondragstart="ds(event,'iam')" ondragend="de(event)">Modify system config</div>
      </div>
      <div style="display:grid; grid-template-columns:repeat(2,1fr); gap:0.75rem;">
        <div class="iam-role-box" ondragover="dov(event)" ondrop="iamDrop(event,'iam-employee')" ondragleave="dlv(event)">
          <div class="iam-role-label">Employee</div>
          <div class="port-chips" id="iam-employee-chips"></div>
        </div>
        <div class="iam-role-box" ondragover="dov(event)" ondrop="iamDrop(event,'iam-hr_manager')" ondragleave="dlv(event)">
          <div class="iam-role-label" style="color:var(--yellow)">HR Manager</div>
          <div class="port-chips" id="iam-hr_manager-chips"></div>
        </div>
        <div class="iam-role-box" ondragover="dov(event)" ondrop="iamDrop(event,'iam-it_admin')" ondragleave="dlv(event)">
          <div class="iam-role-label" style="color:var(--red)">IT Admin</div>
          <div class="port-chips" id="iam-it_admin-chips"></div>
        </div>
        <div class="iam-role-box" ondragover="dov(event)" ondrop="iamDrop(event,'iam-auditor')" ondragleave="dlv(event)">
          <div class="iam-role-label" style="color:var(--purple)">Auditor</div>
          <div class="port-chips" id="iam-auditor-chips"></div>
        </div>
      </div>
      <div class="btn-row" style="margin-top:1.5rem;">
        <button class="btn-primary" onclick="checkIAM()">&#9654; CHECK ANSWER</button>
        <button class="btn-secondary" onclick="resetIAM()">&#8635; RESET</button>
      </div>
      <div class="feedback" id="fb-iam"></div>
    </div>
  </div>

</div>
</main>

<footer>
  <p>CompTIA Security+ SY0-701 ¬∑ Performance-Based Question Simulator</p>
  <p style="margin-top:0.4rem; font-size:0.75rem;"><a href="disclaimer.html" style="color:var(--accent);text-decoration:none;border-bottom:1px dotted var(--accent);">Disclaimer &amp; Legal Notice</a></p>
</footer>

<script>
// ‚îÄ‚îÄ STATE ‚îÄ‚îÄ
let dragSrc = null, dragType = null;
let correct = 0, attempts = 0;
const logAns = { q1: null, q2: null };

// ‚îÄ‚îÄ SCORE ‚îÄ‚îÄ
function updScore() {
  document.getElementById('score-correct').textContent = correct;
  document.getElementById('score-attempts').textContent = attempts;
}

// ‚îÄ‚îÄ TABS ‚îÄ‚îÄ
function switchTab(id, btn, n) {
  document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.nav-tab').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-' + id).classList.add('active');
  btn.classList.add('active');
  document.getElementById('prog-fill').style.width = (n / 8 * 100) + '%';
  document.getElementById('prog-label').textContent = n + ' / 8';
}

// ‚îÄ‚îÄ GENERIC DRAG HELPERS ‚îÄ‚îÄ
function ds(e, type) { dragSrc = e.currentTarget; dragType = type; e.currentTarget.classList.add('dragging'); e.dataTransfer.effectAllowed = 'move'; }
function de(e) { e.currentTarget.classList.remove('dragging'); }
function dov(e) { e.preventDefault(); e.currentTarget.classList.add('dragover'); e.dataTransfer.dropEffect = 'move'; }
function dlv(e) { e.currentTarget.classList.remove('dragover'); }

// ‚îÄ‚îÄ ACL ‚îÄ‚îÄ
function aclDropPool(e) {
  e.preventDefault(); e.currentTarget.classList.remove('dragover');
  if (!dragSrc || dragType !== 'acl') return;
  const num = dragSrc.querySelector('.step-num'); if (num) num.remove();
  document.getElementById('acl-pool').appendChild(dragSrc);
  aclRenumber();
}
function aclDropList(e) {
  e.preventDefault(); e.currentTarget.classList.remove('dragover');
  if (!dragSrc || dragType !== 'acl') return;
  const list = document.getElementById('acl-list');
  const hint = list.querySelector('.drop-hint'); if (hint) hint.remove();
  if (!dragSrc.querySelector('.step-num')) {
    const n = document.createElement('span'); n.className = 'step-num';
    dragSrc.insertBefore(n, dragSrc.firstChild);
  }
  list.appendChild(dragSrc);
  aclRenumber();
}
function aclRenumber() {
  const items = document.getElementById('acl-list').querySelectorAll('.drag-item');
  items.forEach((item, i) => {
    let n = item.querySelector('.step-num');
    if (!n) { n = document.createElement('span'); n.className = 'step-num'; item.insertBefore(n, item.firstChild); }
    n.textContent = i + 1;
  });
}
function checkACL() {
  attempts++; updScore();
  const items = document.getElementById('acl-list').querySelectorAll('.drag-item');
  const rules = Array.from(items).map(i => i.dataset.rule);
  const correct_order = ['PERMIT TCP any 10.10.1.5 443','PERMIT TCP 192.168.1.0/24 10.10.1.5 22','DENY TCP any 10.10.1.5 22','DENY IP any any'];
  const fb = document.getElementById('fb-acl');
  fb.classList.add('show');
  if (rules.length !== 4) {
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Incomplete.</strong> Place exactly 4 rules in the ACL. Don\'t include the HTTP:80 rule ‚Äî the scenario only requires HTTPS.';
    return;
  }
  if (JSON.stringify(rules) === JSON.stringify(correct_order)) {
    correct++; updScore();
    fb.className = 'feedback show correct';
    fb.innerHTML = '‚úÖ <strong>Correct!</strong> Your ACL is properly configured. Permitting HTTPS first allows web traffic; the admin SSH PERMIT before the SSH DENY ensures only 192.168.1.0/24 can SSH in; and the final implicit deny-all blocks everything else. First-match ordering is critical!';
  } else {
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Wrong order.</strong> Remember: (1) PERMIT HTTPS any, (2) PERMIT SSH from admin subnet only, (3) DENY all other SSH, (4) DENY all. The DENY SSH must come <em>after</em> the PERMIT SSH from admin ‚Äî otherwise admins get blocked too!';
  }
}
function resetACL() {
  const pool = document.getElementById('acl-pool'), list = document.getElementById('acl-list');
  Array.from(list.querySelectorAll('.drag-item')).forEach(item => { const n = item.querySelector('.step-num'); if(n) n.remove(); pool.appendChild(item); });
  if (!list.querySelector('.drag-item')) list.innerHTML = '<div class="drop-hint">Drop rules here in the correct order ‚Üì</div>';
  document.getElementById('fb-acl').className = 'feedback';
}

// ‚îÄ‚îÄ NETWORK ‚îÄ‚îÄ
function netDrop(e, zoneId) {
  e.preventDefault(); e.currentTarget.classList.remove('dragover');
  if (!dragSrc || dragType !== 'net') return;
  const chipsId = zoneId === 'net-pool' ? 'net-pool-chips' : zoneId + '-chips';
  document.getElementById(chipsId).appendChild(dragSrc);
}
function checkNet() {
  attempts++; updScore();
  const zones = ['zone-internet','zone-dmz','zone-internal'];
  let wrong = [];
  zones.forEach(z => {
    document.getElementById(z + '-chips').querySelectorAll('.device-chip').forEach(chip => {
      if (chip.dataset.zone !== z) wrong.push(`"${chip.dataset.device}" ‚Üí should be ${chip.dataset.zone.replace('zone-','').toUpperCase()}`);
    });
  });
  const poolLeft = document.getElementById('net-pool-chips').querySelectorAll('.device-chip').length;
  const fb = document.getElementById('fb-net');
  fb.classList.add('show');
  if (poolLeft > 0) { fb.className = 'feedback show incorrect'; fb.innerHTML = '‚ùå <strong>Incomplete.</strong> Place all devices into a zone before checking.'; return; }
  if (wrong.length === 0) {
    correct++; updScore();
    fb.className = 'feedback show correct';
    fb.innerHTML = '‚úÖ <strong>Correct!</strong> Web Server, Public DNS, and Mail Gateway belong in the DMZ ‚Äî publicly accessible but isolated from internal systems. HR Database and Workstations are internal (trusted). External User represents the untrusted internet.';
  } else {
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Wrong placements:</strong> ' + wrong.join('; ') + '. Remember: DMZ = publicly accessible services (web, DNS, mail). Internal = private data and endpoints. Don\'t expose sensitive systems directly to the perimeter.';
  }
}
function resetNet() {
  const pool = document.getElementById('net-pool-chips');
  ['zone-internet','zone-dmz','zone-internal'].forEach(z => {
    document.getElementById(z + '-chips').querySelectorAll('.device-chip').forEach(c => pool.appendChild(c));
  });
  document.getElementById('fb-net').className = 'feedback';
}

// ‚îÄ‚îÄ LOG ANALYSIS ‚îÄ‚îÄ
function logPick(q, letter, el) {
  document.getElementById('log-' + q).querySelectorAll('.log-choice').forEach(c => c.classList.remove('selected'));
  el.classList.add('selected');
  logAns[q] = letter;
}
function checkLog() {
  if (!logAns.q1 || !logAns.q2) {
    const fb = document.getElementById('fb-log');
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå Please answer both questions before checking.';
    return;
  }
  attempts++; updScore();
  const q1ok = logAns.q1 === 'C', q2ok = logAns.q2 === 'C';
  ['q1','q2'].forEach((q,qi) => {
    const ans = qi===0?'C':'C';
    document.getElementById('log-'+q).querySelectorAll('.log-choice').forEach((c,i) => {
      const L = ['A','B','C','D'][i];
      if (L===ans) c.classList.add('correct-ans');
      else if (c.classList.contains('selected') && L!==ans) c.classList.add('wrong-ans');
    });
  });
  const fb = document.getElementById('fb-log');
  fb.classList.add('show');
  if (q1ok && q2ok) {
    correct++; updScore();
    fb.className = 'feedback show correct';
    fb.innerHTML = '‚úÖ <strong>Both correct!</strong><br><strong>Q1:</strong> This is <em>username enumeration</em> ‚Äî cycling through common usernames from one IP rapidly. Unlike spraying (one password ‚Üí many accounts) or brute force (many passwords ‚Üí one account).<br><br><strong>Q2:</strong> MFA + rate limiting is strongest ‚Äî MFA blocks access even if credentials are guessed; rate limiting slows automation. Lockout alone can cause DoS; disk encryption is irrelevant here.';
  } else {
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå ' + (!q1ok ? '<strong>Q1:</strong> The pattern shows many usernames from one IP in rapid succession ‚Äî username enumeration/dictionary attack. ' : '') + (!q2ok ? '<strong>Q2:</strong> MFA + rate limiting is best. Complexity rules don\'t stop automation; disk encryption doesn\'t protect authentication.' : '');
  }
}
function resetLog() {
  logAns.q1 = null; logAns.q2 = null;
  ['q1','q2'].forEach(q => document.getElementById('log-'+q).querySelectorAll('.log-choice').forEach(c => c.classList.remove('selected','correct-ans','wrong-ans')));
  document.getElementById('fb-log').className = 'feedback';
}

// ‚îÄ‚îÄ INCIDENT RESPONSE ‚îÄ‚îÄ
function irDrop(e, targetId) {
  e.preventDefault(); e.currentTarget.classList.remove('dragover');
  if (!dragSrc || dragType !== 'ir') return;
  const target = document.getElementById(targetId);
  const hint = target.querySelector('.drop-hint'); if (hint) hint.remove();
  target.appendChild(dragSrc);
  if (targetId === 'ir-timeline') irRenumber();
}
function irRenumber() {
  document.getElementById('ir-timeline').querySelectorAll('.drag-item').forEach((s,i) => s.dataset.num = i+1);
}
function checkIR() {
  const steps = Array.from(document.getElementById('ir-timeline').querySelectorAll('.drag-item'));
  attempts++; updScore();
  if (steps.length !== 8) {
    const fb = document.getElementById('fb-ir');
    fb.className = 'feedback show incorrect';
    fb.innerHTML = `‚ùå Place all 8 steps in the timeline first. (${steps.length}/8 placed)`;
    return;
  }
  const orders = steps.map(s => parseInt(s.dataset.order));
  const fb = document.getElementById('fb-ir');
  fb.classList.add('show');
  if (JSON.stringify(orders) === JSON.stringify([1,2,3,4,5,6,7,8])) {
    correct++; updScore();
    fb.className = 'feedback show correct';
    fb.innerHTML = '‚úÖ <strong>Perfect!</strong> NIST SP 800-61 order:<br>1Ô∏è‚É£ Detect ‚Üí 2Ô∏è‚É£ Contain (isolate) ‚Üí 3Ô∏è‚É£ Preserve evidence ‚Üí 4Ô∏è‚É£ Analyze scope/IOCs ‚Üí 5Ô∏è‚É£ Eradicate ‚Üí 6Ô∏è‚É£ Recover ‚Üí 7Ô∏è‚É£ Notify ‚Üí 8Ô∏è‚É£ Lessons learned.<br><br><em>Critical rule: Always preserve forensic evidence BEFORE eradication ‚Äî never wipe a system before imaging it!</em>';
  } else {
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Wrong order.</strong> Key rules: Contain <em>immediately</em> after detection. Preserve evidence <em>before</em> eradication. Restore only after confirmed clean. Lessons learned is always last.<br><br>Correct: Detect ‚Üí Isolate ‚Üí Preserve Evidence ‚Üí Analyze ‚Üí Eradicate ‚Üí Restore ‚Üí Notify ‚Üí Lessons Learned';
  }
}
function resetIR() {
  const pool = document.getElementById('ir-pool'), tl = document.getElementById('ir-timeline');
  Array.from(tl.querySelectorAll('.drag-item')).forEach(s => { s.removeAttribute('data-num'); pool.appendChild(s); });
  tl.innerHTML = '<div class="drop-hint">Drop steps here in the correct order ‚Üì</div>';
  document.getElementById('fb-ir').className = 'feedback';
}

// ‚îÄ‚îÄ PORT MATCHING ‚îÄ‚îÄ
function portDrop(e, targetId) {
  e.preventDefault(); e.currentTarget.classList.remove('dragover');
  if (!dragSrc || dragType !== 'port') return;
  if (targetId === 'ports-pool') {
    document.getElementById('ports-pool').appendChild(dragSrc);
  } else {
    const chipsId = targetId + '-chips';
    document.getElementById(chipsId).appendChild(dragSrc);
  }
}
function checkPorts() {
  attempts++; updScore();
  const portMap = { '22': ['SSH','SFTP'], '25': ['SMTP'], '53': ['DNS'], '88': ['Kerberos'], '161': ['SNMP'], '389': ['LDAP'], '443': ['HTTPS'], '990': ['FTPS'], '3389': ['RDP'] };
  let wrong = [];
  const poolLeft = document.getElementById('ports-pool').querySelectorAll('.device-chip').length;
  if (poolLeft > 0) {
    const fb = document.getElementById('fb-ports');
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Incomplete.</strong> Place all service chips into port buckets before checking.';
    return;
  }
  ['22','25','53','88','161','389','443','990','3389'].forEach(port => {
    const chips = document.getElementById('bucket-' + port + '-chips').querySelectorAll('.device-chip');
    chips.forEach(chip => {
      if (!portMap[port].includes(chip.dataset.service)) {
        wrong.push(chip.dataset.service + ' (not port ' + port + ')');
      }
    });
    // check nothing is missing from correct bucket
  });
  const fb = document.getElementById('fb-ports');
  fb.classList.add('show');
  if (wrong.length === 0) {
    correct++; updScore();
    fb.className = 'feedback show correct';
    fb.innerHTML = '‚úÖ <strong>Correct!</strong> Key takeaways: SSH and SFTP both use port 22 (SFTP is SSH-based file transfer, not FTP). FTPS uses port 990 (FTP over SSL ‚Äî different from SFTP). DNS uses both UDP and TCP 53. Kerberos :88 is essential for AD authentication. LDAP :389 vs LDAPS :636 (secure). SNMP :161 is UDP ‚Äî important for network monitoring.';
  } else {
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Wrong placements:</strong> ' + wrong.join(', ') + '.<br><br>Remember: SFTP ‚â† FTPS. SFTP runs over SSH (port 22). FTPS is FTP over SSL/TLS (port 990). RDP is always 3389. SNMP is UDP 161.';
  }
}
function resetPorts() {
  const pool = document.getElementById('ports-pool');
  ['22','25','53','88','161','389','443','990','3389'].forEach(port => {
    document.getElementById('bucket-' + port + '-chips').querySelectorAll('.device-chip').forEach(c => pool.appendChild(c));
  });
  document.getElementById('fb-ports').className = 'feedback';
}

// ‚îÄ‚îÄ CRYPTOGRAPHY ‚îÄ‚îÄ
function cryptoDrop(e, targetId) {
  e.preventDefault(); e.currentTarget.classList.remove('dragover');
  if (!dragSrc || dragType !== 'crypto') return;
  if (targetId === 'crypto-pool') {
    document.getElementById('crypto-pool').appendChild(dragSrc);
  } else {
    const chipsId = targetId + '-chips';
    document.getElementById(chipsId).appendChild(dragSrc);
  }
}
function checkCrypto() {
  const poolLeft = document.getElementById('crypto-pool').querySelectorAll('.device-chip').length;
  if (poolLeft > 0) {
    const fb = document.getElementById('fb-crypto');
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Incomplete.</strong> Place all algorithm chips into categories.';
    return;
  }
  attempts++; updScore();
  let wrong = [];
  ['symmetric','asymmetric','hashing','keyexchange'].forEach(cat => {
    document.getElementById('cat-' + cat + '-chips').querySelectorAll('.device-chip').forEach(chip => {
      if (chip.dataset.cat !== cat) wrong.push(chip.dataset.algo + ' (not ' + cat + ')');
    });
  });
  const fb = document.getElementById('fb-crypto');
  fb.classList.add('show');
  if (wrong.length === 0) {
    correct++; updScore();
    fb.className = 'feedback show correct';
    fb.innerHTML = '‚úÖ <strong>Correct!</strong><br>üîë <strong>Symmetric</strong> (same key): AES, 3DES, ChaCha20 ‚Äî fast, used for bulk encryption<br>üóùÔ∏è <strong>Asymmetric</strong> (key pair): RSA, ECC, DSA ‚Äî slower, used for key exchange and digital signatures<br>üîç <strong>Hashing</strong> (one-way): SHA-256, MD5, BCRYPT ‚Äî integrity verification, password storage<br>ü§ù <strong>Key Exchange</strong>: Diffie-Hellman, ECDH, ECDHE ‚Äî establish shared secrets without transmitting them. ECDHE adds ephemeral keys for perfect forward secrecy.';
  } else {
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Wrong placements:</strong> ' + wrong.join(', ') + '.<br><br>Tip: Symmetric = same key both sides (fast). Asymmetric = public/private key pair (slow). Hashing = one-way, no decryption. Key Exchange = securely agree on a shared secret (DH, ECDH).';
  }
}
function resetCrypto() {
  const pool = document.getElementById('crypto-pool');
  ['symmetric','asymmetric','hashing','keyexchange'].forEach(cat => {
    document.getElementById('cat-' + cat + '-chips').querySelectorAll('.device-chip').forEach(c => pool.appendChild(c));
  });
  document.getElementById('fb-crypto').className = 'feedback';
}

// ‚îÄ‚îÄ VULNERABILITY PRIORITIZATION ‚îÄ‚îÄ
function vulnDrop(e, targetId) {
  e.preventDefault(); e.currentTarget.classList.remove('dragover');
  if (!dragSrc || dragType !== 'vuln') return;
  const target = document.getElementById(targetId);
  const hint = target.querySelector('.drop-hint'); if (hint) hint.remove();
  target.appendChild(dragSrc);
  if (targetId === 'vuln-queue') vulnRenumber();
}
function vulnRenumber() {
  document.getElementById('vuln-queue').querySelectorAll('.vuln-card').forEach((c,i) => c.dataset.num = i+1);
}
function checkVuln() {
  const cards = Array.from(document.getElementById('vuln-queue').querySelectorAll('.vuln-card'));
  if (cards.length !== 5) {
    const fb = document.getElementById('fb-vuln');
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå Place all 5 vulnerabilities in the remediation queue first. (' + cards.length + '/5 placed)';
    return;
  }
  attempts++; updScore();
  const order = cards.map(c => parseInt(c.dataset.priority));
  const fb = document.getElementById('fb-vuln');
  fb.classList.add('show');
  if (JSON.stringify(order) === JSON.stringify([1,2,3,4,5])) {
    correct++; updScore();
    fb.className = 'feedback show correct';
    fb.innerHTML = '‚úÖ <strong>Correct prioritization!</strong><br>1Ô∏è‚É£ <strong>SQL Injection (9.8)</strong> ‚Äî highest CVSS, unauthenticated, full data breach risk<br>2Ô∏è‚É£ <strong>RCE Apache (9.0)</strong> ‚Äî nearly as critical, public exploit available, 30 days unpatched<br>3Ô∏è‚É£ <strong>Admin No MFA (7.5)</strong> ‚Äî internet-exposed admin = serious risk, easy attacker target<br>4Ô∏è‚É£ <strong>TLS 1.0 (5.3)</strong> ‚Äî real risk but requires active MITM and specific conditions<br>5Ô∏è‚É£ <strong>Version Disclosure (3.1)</strong> ‚Äî informational, aids recon but not directly exploitable<br><br><em>Note: CVSS score alone doesn't determine priority ‚Äî exploitability, exposure, and available patches all factor in.</em>';
  } else {
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>Not the optimal order.</strong> Key principle: Prioritize by <em>exploitability √ó impact √ó exposure</em>, not just CVSS score alone. An unauthenticated SQLi that leaks your whole database beats a 9.0 that requires a specific condition. Public exploits dramatically increase urgency. Info disclosures are lowest ‚Äî they aid attackers but aren't directly exploitable.';
  }
}
function resetVuln() {
  const pool = document.getElementById('vuln-pool'), queue = document.getElementById('vuln-queue');
  Array.from(queue.querySelectorAll('.vuln-card')).forEach(c => { c.removeAttribute('data-num'); pool.appendChild(c); });
  queue.innerHTML = '<div class="drop-hint">Drop vulnerabilities here in priority order ‚Üì</div>';
  document.getElementById('fb-vuln').className = 'feedback';
}

// ‚îÄ‚îÄ IAM ACCESS CONTROL ‚îÄ‚îÄ
// IAM uses clone-on-drop since permissions can apply to multiple roles
function iamDrop(e, targetId) {
  e.preventDefault(); e.currentTarget.classList.remove('dragover');
  if (!dragSrc || dragType !== 'iam') return;
  if (targetId === 'iam-pool') {
    // return to pool ‚Äî move original back
    document.getElementById('iam-pool').appendChild(dragSrc);
  } else {
    // clone into role box so original stays in pool
    const chipsId = targetId + '-chips';
    const container = document.getElementById(chipsId);
    // prevent duplicates in same role
    const existing = Array.from(container.querySelectorAll('.device-chip')).map(c => c.dataset.perm);
    if (existing.includes(dragSrc.dataset.perm)) return;
    const clone = dragSrc.cloneNode(true);
    clone.addEventListener('dragstart', (ev) => ds(ev, 'iam'));
    clone.addEventListener('dragend', de);
    // add remove-on-click for role chips
    clone.setAttribute('ondblclick', 'this.remove()');
    clone.title = 'Double-click to remove';
    container.appendChild(clone);
  }
}
function checkIAM() {
  attempts++; updScore();
  // Expected: perm -> array of roles that should have it
  const expected = {
    'View own payslip':         ['employee','hr_manager'],
    'View all employee records':['hr_manager','auditor'],
    'Modify employee salary':   ['hr_manager'],
    'Reset user passwords':     ['it_admin'],
    'Create/delete accounts':   ['it_admin'],
    'View audit logs':          ['it_admin','auditor'],
    'Export payroll data':      ['hr_manager'],
    'Modify system config':     ['it_admin']
  };
  const roles = ['employee','hr_manager','it_admin','auditor'];
  let issues = [];
  roles.forEach(role => {
    const chips = document.getElementById('iam-' + role + '-chips').querySelectorAll('.device-chip');
    const assigned = Array.from(chips).map(c => c.dataset.perm);
    // check for over-privilege
    assigned.forEach(perm => {
      if (!expected[perm] || !expected[perm].includes(role)) {
        issues.push(role.replace('_',' ') + ' should NOT have "' + perm + '"');
      }
    });
    // check for missing permissions
    Object.entries(expected).forEach(([perm, allowedRoles]) => {
      if (allowedRoles.includes(role) && !assigned.includes(perm)) {
        issues.push(role.replace('_',' ') + ' is missing "' + perm + '"');
      }
    });
  });
  const fb = document.getElementById('fb-iam');
  fb.classList.add('show');
  if (issues.length === 0) {
    correct++; updScore();
    fb.className = 'feedback show correct';
    fb.innerHTML = '‚úÖ <strong>Correct!</strong> Least privilege applied properly.<br><br>Key principles tested: <em>Employees</em> only see their own data. <em>HR Managers</em> can view/modify HR data but cannot touch system config. <em>IT Admins</em> manage infrastructure but should NOT access payroll or HR records. <em>Auditors</em> have read-only access to records and logs for compliance ‚Äî never write access. Separation of duties prevents any one role from having too much power.';
  } else {
    const shown = issues.slice(0,4);
    fb.className = 'feedback show incorrect';
    fb.innerHTML = '‚ùå <strong>' + issues.length + ' issue(s):</strong> ' + shown.join('; ') + (issues.length>4?'...':'') + '.<br><br>Remember: Least privilege = minimum access needed. IT Admin ‚â† HR access. Auditors = read-only. Employees = own data only. Double-click a chip in a role box to remove it.';
  }
}
function resetIAM() {
  ['employee','hr_manager','it_admin','auditor'].forEach(role => {
    document.getElementById('iam-' + role + '-chips').innerHTML = '';
  });
  document.getElementById('fb-iam').className = 'feedback';
}

</script>
</body>
</html>
